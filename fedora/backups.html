

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; default-src 'self'; style-src 'self' https://github.githubassets.com/ cdn.jsdelivr.net stackpath.bootstrapcdn.com; script-src 'self'; img-src 'self'; media-src 'self'; font-src 'self' fonts.gstatic.com cdn.jsdelivr.net stackpath.bootstrapcdn.com;">
  
  
  <title>Backups &mdash; Linux Guide and Hints</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="../_static/css/prism-okaidia.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/toggle.css" type="text/css" />
    
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bup" href="bup.html" />
    <link rel="prev" title="Getting started" href="../gettingstarted.html" /> 

  <noscript>
      <link rel="stylesheet" href="../_static/css/nojs.css" type="text/css">
  </noscript>

</head>

<body class="wy-body-for-nav" role="document">
<a class="sr-only sr-only-focusable" href="#main">Skip to main content</a>

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Linux Guide and Hints
          

          
            
            <img src="../_static/img/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.6
              </div>
            
          

          
<form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <div role="search">
        <input type="text" aria-label="Search docs" name="q" placeholder="Search docs" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </div>
</form>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Errata</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../errata/removed.html">Errata</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../errata/removed.html#removed-articles">Removed articles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../errata/removed.html#removed-information">Removed information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../errata/upcoming.html">Upcoming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../errata/upcoming.html#annoucements">Annoucements</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Security</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../security/antipatterns.html">Anti-patterns</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security/antipatterns.html#not-using-https">Not using HTTPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/antipatterns.html#insecure-requests">Insecure requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/antipatterns.html#using-insecure-ciphers">Using insecure ciphers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security/antipatterns.html#password-security">Password security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/antipatterns.html#using-deprecated-hashing-functions">Using deprecated hashing functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/antipatterns.html#arbitrary-password-lengths">Arbitrary password lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/antipatterns.html#client-side-hashing">Client-side hashing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security/antipatterns.html#disabling-mitigations">Disabling mitigations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/antipatterns.html#disabling-selinux">Disabling SELinux</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security/passwords.html">Password management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security/passwords.html#backing-your-databases-up-to-your-phone">Backing your databases up to your phone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/passwords.html#faq">FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/passwords.html#isn-t-using-a-single-password-bad">Isn’t using a single password bad?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/passwords.html#but-your-master-password-can-be-stolen-by-a-keylogger">But your master password can be stolen by a keylogger</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/euphemism.html">The Euphemism Review</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/euphemism.html#please-don-t-say-timeframe">Please don’t say “timeframe”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc/ipv6he.html">Hurricane Electric IPv6 Tunnel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/mingw.html">MinGW</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/mingw.html#why-not-use-wsl">Why not use WSL?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc/port465.html">Is port 465 deprecated?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/vnc.html">VNC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/vnc.html#setup">Setup</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Fedora</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#other-things-negativo17-related">Other things negativo17 related</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Backups</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Duplicity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gpg">GPG</a></li>
<li class="toctree-l2"><a class="reference internal" href="#keychain">Keychain</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unattended-backups">Unattended backups</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">git-annex</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bup.html">Bup</a></li>
<li class="toctree-l1"><a class="reference internal" href="cipc.html">Cisco IP Communicator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cipc.html#installing-via-playonlinux">Installing via PlayOnLinux</a></li>
<li class="toctree-l2"><a class="reference internal" href="cipc.html#installing-via-regular-wine">Installing via Regular Wine</a></li>
<li class="toctree-l2"><a class="reference internal" href="cipc.html#pulse-audio">Pulse Audio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="clang.html">Clang</a><ul>
<li class="toctree-l2"><a class="reference internal" href="clang.html#msan-line-numbers">MSan line numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="clang.html#clang-format">clang-format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="copr.html">COPR</a><ul>
<li class="toctree-l2"><a class="reference internal" href="copr.html#gzdoom">gzdoom</a></li>
<li class="toctree-l2"><a class="reference internal" href="copr.html#ircd">ircd</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dnscrypt.html">dnscrypt</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docker.html#changing-the-data-directory">Changing the data directory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="emulators.html">Emulators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#dolphin">Dolphin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#wii-controls">Wii controls</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#game-idiosyncrasies">Game idiosyncrasies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="emulators.html#paper-mario-the-thousand-year-door">Paper Mario: The Thousand-Year Door</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#retroarch">RetroArch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#building-beetle-psx-libretro-mednafen">Building beetle-psx-libretro (mednafen)</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#enabling-the-vulkan-renderer-and-32-bit-color">Enabling the Vulkan renderer and 32-bit color</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#shaders">Shaders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#mednafen-randomly-speeds-up">mednafen randomly speeds up</a></li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#mupen64plus-unofficial-faq">Mupen64Plus unofficial FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#where-does-mupen64plus-like-to-put-files">Where does Mupen64Plus like to put files?</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#i-m-getting-a-dlopen-error">I’m getting a <code class="docutils literal notranslate"><span class="pre">dlopen</span></code> error</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#keycode-values">Keycode values</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#i-changed-one-of-the-hi-res-textures-and-no-change-is-visible">I changed one of the hi-res textures and no change is visible</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#recommended-plugins">Recommended plugins?</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#how-do-i-compile-it">How do I compile it?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#gba">GBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#id1">MAME</a><ul>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="emulators.html#example-mame-ini">Example <code class="docutils literal notranslate"><span class="pre">mame.ini</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="emulators.html#example-command-line-options">Example command line options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#speed">Speed</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#ui-script">UI script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#id2">mGBA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#controller-joystick-issue">Controller/joystick issue</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#building">Building</a><ul>
<li class="toctree-l4"><a class="reference internal" href="emulators.html#cmake-variables">CMake variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="emulators.html#dependencies">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#link-cable-support">Link cable support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#id3">BGB</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#id4">mGBA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html#kega-fusion">Kega Fusion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#id5">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#id6">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="emulators.html#no-sound">No Sound?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="firefox.html">Firefox</a><ul>
<li class="toctree-l2"><a class="reference internal" href="firefox.html#disable-automatic-redirect-to-a-website-if-typing-an-invalid-url">Disable automatic redirect to a website if typing an invalid URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="firefox.html#glitchy-ui-when-using-custom-gtk-theme">Glitchy UI when using custom GTK theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="firefox.html#disable-network-http-referer-spoofsource">Disable <code class="docutils literal notranslate"><span class="pre">network.http.referer.spoofSource</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gcc.html">GCC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gcc.html#installing-prerequisites-gmp-mpfr-mpc">Installing prerequisites: GMP, MPFR, MPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="gcc.html#building">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="gcc.html#docker">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="gcc.html#invalid-instruction-suffix-for">“invalid instruction suffix for”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="git.html">Git</a><ul>
<li class="toctree-l2"><a class="reference internal" href="git.html#setting-up-cloudflare-and-github-pages">Setting up Cloudflare and Github pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="git.html#gpg">GPG</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gitlab.html">Gitlab</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gitlab.html#ssh-and-git-access">SSH and Git access</a></li>
<li class="toctree-l2"><a class="reference internal" href="gitlab.html#enabling-https-with-let-s-encrypt">Enabling HTTPS with Let’s Encrypt</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gnometips.html">GNOME Tips</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gnometips.html#system-tray">System Tray</a></li>
<li class="toctree-l2"><a class="reference internal" href="gnometips.html#add-minimize-maximize">Add minimize/maximize</a></li>
<li class="toctree-l2"><a class="reference internal" href="gnometips.html#pidgin">Pidgin</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="grub.html">GRUB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="grub.html#fedora-grub-menu-missing">Fedora Grub Menu Missing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iphone.html">iPhone</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="kubernetes.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mcafee.html">McAfee</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="misc.html#using-ld-library-path-in-fish">Using <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> in Fish</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#unable-to-find-liblzma">Unable to find <code class="docutils literal notranslate"><span class="pre">LibLZMA</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#unable-to-find-wxwidgets">Unable to find <code class="docutils literal notranslate"><span class="pre">wxWidgets</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#update-all-repositories-in-the-current-directory">Update all repositories in the current directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#youcompleteme-crashes-due-to-libtinfo-so-version-mismatch">YouCompleteMe crashes due to <code class="docutils literal notranslate"><span class="pre">libtinfo.so</span></code> version mismatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#keepasshttp-no-longer-works">KeePassHttp no longer works</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#disable-tcp-ip-and-use-sockets-for-mysql">Disable TCP/IP and use sockets for MySQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#selinux-is-preventing-abrt-action-sav-from-write-access-on-the-directory-var-lib-rpm">SELinux is preventing <code class="docutils literal notranslate"><span class="pre">abrt-action-sav</span></code> from write access on the directory /var/lib/rpm</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#swapping-desktop-environments">Swapping Desktop Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html#upon-logging-into-xfce-desktop-freezes-until-you-switch-to-another-tty">Upon logging into XFCE, desktop freezes until you switch to another TTY</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mpv.html">mpv</a></li>
<li class="toctree-l1"><a class="reference internal" href="negativo.html">negativo17 repositories and Nvidia drivers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="negativo.html#multimedia">Multimedia</a></li>
<li class="toctree-l2"><a class="reference internal" href="negativo.html#nvidia">Nvidia</a></li>
<li class="toctree-l2"><a class="reference internal" href="negativo.html#dkms">DKMS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="packaging.html">Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="pip.html">pip</a></li>
<li class="toctree-l1"><a class="reference internal" href="powerline.html">Powerline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="powerline.html#installing-via-dnf">Installing via <code class="docutils literal notranslate"><span class="pre">dnf</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="powerline.html#enabling-powerline-installed-via-dnf">Enabling powerline (installed via <code class="docutils literal notranslate"><span class="pre">dnf</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="powerline.html#fish">Fish</a><ul>
<li class="toctree-l4"><a class="reference internal" href="powerline.html#oh-my-fish">oh-my-fish</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="powerline.html#vim">vim</a></li>
<li class="toctree-l3"><a class="reference internal" href="powerline.html#tmux">tmux</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pulseaudio.html">Pulseaudio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pulseaudio.html#flat-volume">Flat Volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="pulseaudio.html#sound-crackling">Sound Crackling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tmux.html">tmux</a></li>
<li class="toctree-l1"><a class="reference internal" href="vim.html">vim</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vim.html#plugins">Plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="virtualbox.html">VirtualBox</a><ul>
<li class="toctree-l2"><a class="reference internal" href="virtualbox.html#failed-to-start-load-kernel-modules-after-uninstalling">“Failed to start Load Kernel Modules” after uninstalling</a></li>
<li class="toctree-l2"><a class="reference internal" href="virtualbox.html#kernel-modules-do-not-build-upon-kernel-update">Kernel modules do not build upon kernel update</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vmware.html">VMware</a></li>
<li class="toctree-l1"><a class="reference internal" href="winetips.html">Wine Tips</a><ul>
<li class="toctree-l2"><a class="reference internal" href="winetips.html#out-of-memory-errors">Out of memory errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="winetips.html#new-vegas">New Vegas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="winetips.html#modding">Modding</a></li>
<li class="toctree-l3"><a class="reference internal" href="winetips.html#loot">LOOT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="winetips.html#gmdx">GMDX</a></li>
<li class="toctree-l2"><a class="reference internal" href="winetips.html#proton">Proton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="winetips.html#mf-install">mf_install</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xscreensaver.html">XScreenSaver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="xscreensaver.html#gamma-or-brightness-is-too-high-when-unlocking">Gamma or brightness is too high when unlocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="xscreensaver.html#disable-fade-to-black-effect">Disable fade to black effect</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">CentOS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../centos/builds.html">Auto-Provisioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../centos/freeipa.html">FreeIPA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#tutorial-preface-notes-and-recommendations">Tutorial Preface, Notes, and Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#dns">DNS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#delegation">Delegation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#server-setup">Server Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#required-packages">Required Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#replica">Replica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#replica-automation">Replica Automation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#server-migration-upgrade">Server Migration/Upgrade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#active-directory-trust">Active Directory Trust</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#disable-anonymous-bind">Disable Anonymous Bind</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#client-setup">Client Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#rhel-7-8">RHEL 7 &amp; 8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#mac-clients">Mac Clients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#discovery-and-settings">Discovery and Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#suse">SUSE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#hbac">HBAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#sudo">SUDO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#legacy-client-setup">Legacy Client Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#solaris-10">Solaris 10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#solaris-11">Solaris 11</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#automated-scripts">Automated Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#ad-trust-double-uid">AD Trust Double UID</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#omnios-illumos">OmniOS/Illumos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#legacy-hbac">Legacy HBAC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#id2">Solaris 10</a></li>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#id3">Solaris 11</a></li>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#omnios">Omnios</a></li>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#pam-hbac-conf">pam_hbac.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#pam-configuration">PAM Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#login-with-ad-users-to-legacy-clients">Login with AD Users to Legacy Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#legacy-active-directory-trust-notes">Legacy Active Directory Trust Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#domain-resolution-order-oddness">Domain Resolution Order Oddness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#solaris-weirdness">Solaris Weirdness</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#domain-options">Domain Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#remove-realm-for-ad-users">Remove &#64;realm for AD users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#ad-and-ipa-group-names-with-short-names">AD and IPA group names with short names</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#sites-and-ad-dc-s">Sites and AD DC’s</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#rhel-6-sudo-and-default-domain-suffix">RHEL 6 SUDO and Default Domain Suffix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#set-default-shell-for-ad-users">Set Default Shell for AD Users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#automated-kerberos-principals">Automated Kerberos Principals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#hadoop-cloudera">Hadoop/Cloudera</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#cloudera-manager-woes">Cloudera Manager Woes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../centos/freeipa.html#the-solution">The Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#dns-forwarding">DNS Forwarding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#dns-forwarding-to-dot">DNS Forwarding to DoT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#logging">Logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#audit-logs">Audit Logs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#certificates">Certificates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#renewed-ipa-http-certificate-stuck">Renewed IPA HTTP Certificate Stuck</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#ca-related-certificates-stuck">CA Related Certificates Stuck</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/freeipa.html#kerberos">Kerberos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/freeipa.html#accounts-with-otp-enabled">Accounts with OTP Enabled</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../centos/nat.html">NAT/Router</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../centos/nat.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/nat.html#tutorial">Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/nat.html#interface-setup">Interface Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/nat.html#firewalld">FirewallD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/nat.html#iptables">iptables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/nat.html#nftables">nftables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/nat.html#ipv6-forwarding">IPv6 Forwarding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/nat.html#dhcp">DHCP</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../centos/openldap.html">OpenLDAP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../centos/openldap.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/openldap.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/openldap.html#tutorial-preface-notes-and-recommendations">Tutorial Preface, Notes, and Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/openldap.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#packages">Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#certificates">Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#ldap-server-configuration">LDAP Server Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#ldap-structure">LDAP Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#add-users-via-migration">Add Users via Migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#add-users-via-ldif">Add Users via LDIF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#nfs-export-home-directories">NFS Export Home Directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#firewall">Firewall</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/openldap.html#client">Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#rhel-6-rhel-7-fedora-20">RHEL 6/RHEL 7/Fedora 20+</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#automounting-home-directories">Automounting Home Directories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../centos/openldap.html#ldap-structure-add-ons">LDAP Structure Add-ons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#sudo">SUDO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#member-groups">Member Groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#referential-integrity">Referential Integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#acl">ACL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#disable-anonymous-binding">Disable Anonymous Binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#ldap-logging">LDAP Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/openldap.html#password-policy">Password Policy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../centos/sysadmin.html">The System Administrator Experience</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../centos/sysadmin.html#recommendations">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/sysadmin.html#certification-completions">Certification Completions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/sysadmin.html#notes-and-changelog">Notes and Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/sysadmin.html#begin">Begin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#setup-a-kvm-hypervisor">Setup a KVM Hypervisor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#dhcp-and-dns">DHCP and DNS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#server-and-content-management">Server and Content Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#connect-content-management-to-hypervisor">Connect Content Management to Hypervisor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#spin-up-vm-s-using-katello-spacewalk">Spin Up VM’s Using Katello/Spacewalk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#setup-freeipa">Setup FreeIPA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#spin-up-two-vm-s-for-databases">Spin Up Two VM’s for Databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#spin-up-configuration-management">Spin Up Configuration Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#spin-up-vm-for-nfs-iscsi">Spin Up VM for NFS/iSCSI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#deploy-bacula-server">Deploy Bacula Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#deploy-four-vm-s">Deploy Four VM’s</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#deploy-load-balancer-vm">Deploy Load Balancer VM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#deploy-postfix-vm">Deploy Postfix VM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#setup-nagios-vm">Setup Nagios VM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#setup-syslog-vm">Setup Syslog VM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#document-your-work">Document Your Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#rpm-build-server">RPM Build Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#git-server">Git Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/sysadmin.html#ansible">Ansible</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../centos/unbound.html">Unbound</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../centos/unbound.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos/unbound.html#setup">Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../centos/unbound.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../centos/unbound.html#dns-over-tls-dot">DNS over TLS (DoT)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">MacOS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../macos/image.html">Create macOS ISO Images</a></li>
</ul>
<p class="caption"><span class="caption-text">Training Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../training/ex362.html">EX362 Exam Prep</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#exam-information">Exam Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#resources">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#hardware-recommendations">Hardware Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#installing-freeipa-red-hat-idm-with-replicas-for-growth-and-scale">Installing FreeIPA/Red Hat IdM with replicas for growth and scale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#creating-users-groups-and-policies">Creating Users, Groups, and Policies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../training/ex362.html#new-passwords-expired">New Passwords Expired</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#install-and-configure-idm-clients">Install and configure IdM Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#configure-roaming-automounted-home-directories">Configure roaming/automounted home directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#use-the-rest-api-to-query-idm">Use the REST api to query IdM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#configure-kerberized-services">Configure Kerberized services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#create-a-trust-with-active-directory">Create a trust with Active Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#configure-control-policies-and-user-access">Configure/control policies and user access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../training/ex362.html#rbac">RBAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/ex362.html#hbac">HBAC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#configure-and-manage-a-certificate-authority">Configure and manage a certificate authority</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#back-up-an-idm-infrastructure">Back up an IdM infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#configure-idm-as-an-ldap-backend-for-external-services">Configure IdM as an LDAP backend for external services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../training/ex362.html#kerberos">Kerberos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex362.html#implement-a-sso">Implement a SSO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../training/ex407.html">EX407 Exam Prep</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../training/ex407.html#overview">Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../training/ex415.html">EX415 Exam Prep</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#exam-information">Exam Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#resources">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#use-red-hat-ansible-engine">Use Red Hat Ansible Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#configure-intrusion-detection">Configure Intrusion Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#configure-encrypted-storage">Configure Encrypted Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#restrict-usb-devices">Restrict USB Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#manage-system-login-security-using-pluggable-authentication-modules-pam">Manage System Login Security using Pluggable Authentication Modules (PAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#configure-system-auditing">Configure System Auditing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#configure-selinux">Configure SELinux</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../training/ex415.html#package-binary-glossary">Package &amp; Binary Glossary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../training/ex415.html#command-glossary">Command Glossary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../training/ex415.html#enforce-security-compliance">Enforce Security Compliance</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">About Us</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/contributors.html">Contributors</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Linux Guide and Hints</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Backups</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/nazunalika/linux-guide-and-hints/blob/master/source/fedora/backups.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <main role="main" id="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="backups">
<h1>Backups<a class="headerlink" href="#backups" title="Permalink to this headline">¶</a></h1>
<p>While there is a variety of backup software out there, this article will only
cover two: <a class="reference external" href="http://duplicity.nongnu.org/">duplicity</a> and <a class="reference external" href="https://git-annex.branchable.com/">git-annex</a>. git-annex is not backup software in of
itself, but it is still useful for such a purpose.</p>
<div class="section" id="id1">
<h2>Duplicity<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Duplicity uses a GPG encrypted tar format. The primary advantage of duplicity
is that the archives are very small compared to alternatives (see
<a class="reference external" href="https://github.com/gilbertchen/benchmarking">gilbertchen’s benchmarks</a>).
The two major disadvantages is that backup/restore time is lengthy and that the
incremental backups are useless without the full backup in the chain. One thing
I will give to Duplicity compared to Duplicacy is that the command-line
interface is superior.</p>
<div class="card">
<div class="card-header bg-danger">
<i class='fa fa-exclamation-circle'></i> Danger</div><div class="card-body">
Duplicity is undergoing a Python 2 to 3 transition, which seems to be
resulting in a lot of bugs. Use at your own risk.</div></div>
<div class="card">
<div class="card-header bg-warning">
<i class='fa fa-exclamation-circle'></i> Warning</div><div class="card-body">
I’m not sure if this is a bug or not, but you should be aware that for
include/exclude patterns, specifying a path like <code class="docutils literal notranslate"><span class="pre">/path/to/go</span></code> will also
match <code class="docutils literal notranslate"><span class="pre">/path/to/gopher</span></code>, even when not using a wildcard.</div></div>
</div>
<div class="section" id="gpg">
<h2>GPG<a class="headerlink" href="#gpg" title="Permalink to this headline">¶</a></h2>
<p>In order to instruct Duplicity to use <code class="docutils literal notranslate"><span class="pre">gpg2</span></code>, pass <code class="docutils literal notranslate"><span class="pre">--gpg-binary='gpg2'</span></code>.
You can then either use the <code class="docutils literal notranslate"><span class="pre">PASSPHRASE</span></code> environment variable or the
<code class="docutils literal notranslate"><span class="pre">--use-agent</span></code> flag. If you go with the former route, your passphrase will be
in cleartext, but if it’s in your crontab or protected with <code class="docutils literal notranslate"><span class="pre">700</span></code> permissions
only your user can read it. For the latter, you may opt to keep your passphrase
cached so that you can run the backups unattended. Add these to your
<code class="docutils literal notranslate"><span class="pre">~/.gnupg/gpg-agent.conf</span></code>:</p>
<pre><code class="language-none">default-cache-ttl 34560000
max-cache-ttl 34560000</code></pre><p>Then reload the GPG agent (either <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">RELOADAGENT</span> <span class="pre">|</span> <span class="pre">gpg-connect-agent</span></code> or
<code class="docutils literal notranslate"><span class="pre">gpgconf</span> <span class="pre">--kill</span> <span class="pre">gpg-agent</span></code>).</p>
</div>
<div class="section" id="keychain">
<h2>Keychain<a class="headerlink" href="#keychain" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/funtoo/keychain">Keychain</a> is a front-end for
<code class="docutils literal notranslate"><span class="pre">ssh-agent</span></code> and <code class="docutils literal notranslate"><span class="pre">gpg-agent</span></code>. It will cache your keys and export environment
variables (<code class="docutils literal notranslate"><span class="pre">SSH_AUTH_SOCK</span></code>, etc.) that can be sourced for non-interactive
scripts like crontabs. At the time of writing, Fedora ships version 2.8.0,
which is too old for our purposes. The latest version at the time of writing
(2.8.5) allows us to use GPG2. Since it’s just a shell script, installation is
simple:</p>
<pre><code class="language-bash">git clone git@github.com:funtoo/keychain.git
cd keychain && make
cp keychain ~/.local/bin/</code></pre><p>Unless specified, Keychain will not start <code class="docutils literal notranslate"><span class="pre">gpg-agent</span></code> nor use <code class="docutils literal notranslate"><span class="pre">gpg2</span></code>. Further,
you need to explicitly specify which keys to use (i.e, <code class="docutils literal notranslate"><span class="pre">id_rsa</span></code>). You will also need
to invoke Keychain from your shell startup scripts. For Bash, this will look like:</p>
<pre><code class="language-bash"># Environment variables automatically sourced, no need to do it manually here
eval `keychain --agents gpg,ssh --gpg2 --eval id_rsa some_gpg_key_id`</code></pre><p>For Fish:</p>
<pre><code class="language-fish">if status --is-interactive
    keychain --agents gpg,ssh --gpg2 --eval id_rsa some_gpg_key_id
end

if test -f ~/.keychain/(hostname)-gpg-fish
    source ~/.keychain/(hostname)-gpg-fish
end

if test -f ~/.keychain/(hostname)-fish
    source ~/.keychain/(hostname)-fish
end</code></pre><div class="card">
<div class="card-header bg-info">
<i class='fa fa-exclamation-circle'></i> Note</div><div class="card-body">
At the time of writing the Fish example in the man Keychain page is broken.
This example was pulled from <a class="reference external" href="https://github.com/fish-shell/fish-shell/issues/4583">issue #4583</a> in the Fish issue
tracker.</div></div>
<p>Finally, add this to the top of your cron jobs:</p>
<pre><code class="language-bash">[ -z "$HOSTNAME" ] && HOSTNAME=$(uname -n)
[ -f "$HOME/.keychain/$HOSTNAME-sh" ] && \
    source "$HOME/.keychain/$HOSTNAME-sh" 2>/dev/null
[ -f "$HOME/.keychain/$HOSTNAME-sh-gpg" ] && \
    source "$HOME/.keychain/$HOSTNAME-sh-gpg" 2>/dev/null</code></pre></div>
<div class="section" id="unattended-backups">
<h2>Unattended backups<a class="headerlink" href="#unattended-backups" title="Permalink to this headline">¶</a></h2>
<div class="card">
<div class="card-header bg-info">
<i class='fa fa-exclamation-circle'></i> Note</div><div class="card-body">
If you intend to use systemd, it cannot be used within a (user) cron tab. It can only
run within a login session or be run as root.</div></div>
<p>However, two commands you may find useful are <code class="docutils literal notranslate"><span class="pre">flock</span></code> and
<code class="docutils literal notranslate"><span class="pre">systemd-inhibit</span></code>. <code class="docutils literal notranslate"><span class="pre">flock</span></code> will allow you to prevent jobs from overlapping. You can also
wake up the system by writing a systemd unit and using the <code class="docutils literal notranslate"><span class="pre">WakeSystem</span></code> property. Example:</p>
<pre><code class="language-bash">[Unit]
Description=Weekly backup

[Timer]
Unit=weekly_backup.service
OnCalendar=Sun 23:00:00
WakeSystem=true

[Install]
WantedBy=multi-user.target</code></pre><p>And the corresponding service file:</p>
<pre><code class="language-bash">[Unit]
Description=Weekly backup

[Service]
Type=oneshot
ExecStartPre=/bin/sleep 1m
ExecStart=/bin/systemd-inhibit /bin/su -c "/usr/bin/flock -w 0 /path/to/cron.lock # ...</code></pre><p>We sleep before running <code class="docutils literal notranslate"><span class="pre">systemd-inhibit</span></code> because there’s a race condition if
it runs while the system is still waking from suspend. See this <a class="reference external" href="https://lists.freedesktop.org/archives/systemd-devel/2019-April/042423.html">mailing list
post</a>
for details.</p>
<div class="card">
<div class="card-header bg-info">
<i class='fa fa-exclamation-circle'></i> Note</div><div class="card-body">
The service files should <strong>not</strong> have an [Install] section. When you enable the units,
only enable the timers.</div></div>
<p>Read <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">systemd.time</span></code> for what format <code class="docutils literal notranslate"><span class="pre">OnCalendar</span></code> takes. You can verify
the time format is correct by using <code class="docutils literal notranslate"><span class="pre">systemd</span> <span class="pre">calendar</span></code>. Since <code class="docutils literal notranslate"><span class="pre">WakeSystem</span></code>
requires privileges, this cannot be a per-user unit. So place them inside
<code class="docutils literal notranslate"><span class="pre">/etc/systemd/system</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">flock</span></code> ensures that if there’s a conflict, the monthly (i.e, full backup) job will take
precedence. You can run <code class="docutils literal notranslate"><span class="pre">fuser</span> <span class="pre">-v</span> <span class="pre">/path/to/cron.lock</span></code> to see what processes are holding
a lock.</p>
<p><code class="docutils literal notranslate"><span class="pre">systemd-inhibit</span></code> on the other hand will prevent the system from suspending
until the given command is complete. Per the <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-inhibit.html">documentation</a>, it
can inhibit a variety of operations. By default, this is
<code class="docutils literal notranslate"><span class="pre">idle:sleep:shutdown</span></code> but laptop users will find <code class="docutils literal notranslate"><span class="pre">handle-lid-switch</span></code>
useful.</p>
<p>Alternatively, if you choose not to use <code class="docutils literal notranslate"><span class="pre">systemd-inhibit</span></code>, you can simply adjust the power
management inactivity value. For example, on XFCE this would look like:</p>
<pre><code class="language-shell">xfconf-query -c xfce4-power-manager -p /xfce4-power-manager/inactivity-on-ac -s 0</code></pre><p>This has the advantage of not requiring root privileges.</p>
</div>
<div class="section" id="id3">
<h2>git-annex<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>git-annex is a location/metadata tracker that’s built on top of git. It essentially adds new verbs
(prefixed with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annex</span></code>) to any configured repository. There are a few things to keep in mind:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annex</span> <span class="pre">init</span></code> may not initialize the repository with the latest version. i.e, if you have
git-annex v6, the repository may be v5. In that case, you should run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annex</span> <span class="pre">upgrade</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annex</span> <span class="pre">sync</span></code> needs to be run in each repository, not just one, if you are using a distributed
rather than centralized workflow</li>
<li>In v6, once a file is unlocked, it remains unlocked. If you make frequent changes to files you should
use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annex</span> <span class="pre">unlock</span></code> since direct mode is deprecated</li>
</ul>
<p>As far as I’m aware, git-annex doesn’t track permissions or xattrs (important
for SELinux). However, etckeeper has some helper scripts which store and
restore metadata: <a class="reference external" href="https://git.joeyh.name/index.cgi/etckeeper.git/tree/commit.d/20store-metadata">20store-metadata</a>
and <a class="reference external" href="https://git.joeyh.name/index.cgi/etckeeper.git/tree/init.d/20restore-etckeeper">20restore-etckeeper</a>
respectively. Rename the scripts to <code class="docutils literal notranslate"><span class="pre">git-store-metadata</span></code> and
<code class="docutils literal notranslate"><span class="pre">git-restore-metadata</span></code> and add them to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.  You will need to set
the <code class="docutils literal notranslate"><span class="pre">VCS</span></code> environment variable to <code class="docutils literal notranslate"><span class="pre">git</span></code>.</p>
<p>In order to restore security contexts, you can simply use <code class="docutils literal notranslate"><span class="pre">chcon</span> <span class="pre">-R</span>
<span class="pre">--reference=source_dir/</span> <span class="pre">target_dir/</span></code>, where <code class="docutils literal notranslate"><span class="pre">source_dir</span></code> contains the
context you want to apply to <code class="docutils literal notranslate"><span class="pre">target_dir</span></code>.</p>
<p>The following helper script should get you started:</p>
<pre><code class="language-bash">#!/bin/bash

set -x
set -o pipefail
shopt -s dotglob

function fail {
    echo "Fail."
    exit 1
}

# Import environment variables SSH_AUTH_SOCK, etc.
[ -z "$HOSTNAME" ] && HOSTNAME=$(uname -n)
[ -f "$HOME/.keychain/$HOSTNAME-sh" ] && \
    source "$HOME/.keychain/$HOSTNAME-sh" 2>/dev/null
[ -f "$HOME/.keychain/$HOSTNAME-sh-gpg" ] && \
    source "$HOME/.keychain/$HOSTNAME-sh-gpg" 2>/dev/null

cd "$HOME/backup" || fail
# We need to unlock the files in order to allow modifications. Note that direct
# mode is deprecated.
git annex unlock ./* || fail

# ...snip...
# Copy your files to backup here
# If using cp, make sure you use -a to preserve permissions and xattrs
# If using rsync, make sure you use -avzAX
# ...snip...

# We use git add and not git annex add here to add the files directly.
# Adding them to the annex would create symlinks, which do not preserve
# permissions.
git-store-metadata
git add --all || fail
git annex sync --content --message="$(date +%F)" || fail

# For each remote we need to run sync in order to actually
# propagate the changes. Doing sync from the initial directory
# only creates a branch with the changes. Running sync in the target
# directory performs the merge.
for remote in $(git remote)
do
    URL=$(git remote get-url "$remote")
    cd "$URL" || fail
    git annex sync --content --message="$(date +%F)" || fail
    git-restore-metadata
done</code></pre></div>
</div>


           </div>
           
          </main>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bup.html" class="btn btn-neutral float-right" title="Bup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../gettingstarted.html" class="btn btn-neutral" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, remyabel, nazunalika

    </p>
    <p><small>We are not affiliated with Red Hat&reg;, Fedora&reg;, Rocky Linux&reg; or CentOS&reg;. Red Hat&reg;, Fedora&reg; and CentOS&reg; are registered trademarks of Red Hat, Inc. in the United States and other countries. Linux&reg; is the registered trademark of Linus Torvalds in the U.S. and other countries. Rocky Linux&reg; is a registered trademark of the Rocky Enterprise Software Foundation. Inc. in the United States.</small></p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

  <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/js/documentation_options.js" defer></script>
      <script type="text/javascript" src="../_static/jquery.js" defer></script>
      <script type="text/javascript" src="../_static/underscore.js" defer></script>
      <script type="text/javascript" src="../_static/doctools.js" defer></script>
      <script type="text/javascript" src="../_static/js/prism.min.js" defer></script>
      <script type="text/javascript" src="../_static/js/components/prism-bash.min.js" defer></script>
      <script type="text/javascript" src="../_static/js/components/prism-docker.min.js" defer></script>
      <script type="text/javascript" src="../_static/js/prism-freeipa.min.js" defer></script>
      <script type="text/javascript" src="../_static/js/toggle.js" defer></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js" defer></script>
  

  <script type="text/javascript" src="../_static/js/stickynav.js" defer></script> 

</body>
</html>